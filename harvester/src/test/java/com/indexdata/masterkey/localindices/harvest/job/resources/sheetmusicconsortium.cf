<connector><metaData><meta name="cfbuilder_version" content="2.17.5"/></metaData><property type="array" name="whitelist"/><property type="array" name="blacklist"/><task name="harvest" polymorphic="false"><step name="skip" version="1.1"><stepConf type="object"><reqVer type="string">1.1</reqVer><compareTo type="object"><path type="string">$.input</path><key type="string">resumptiontoken</key></compareTo><rel type="string">eq</rel><expArgVal type="string">continues</expArgVal><useRegex type="bool">false</useRegex><stepsToSkip type="number">3</stepsToSkip><skipAll type="bool">false</skipAll><destType type="string">Skip</destType></stepConf></step><step name="click" version="1.0"><stepConf type="object"><reqVer type="string">1.0</reqVer><target type="object"><namespaces type="object"/><frames type="array"/><xpath type="string">//a[@class="nextResultsButton"]</xpath></target><wait type="object"><active type="bool">true</active><detector type="string">justObserve</detector><timeout type="number">30000</timeout><errorOnTimeout type="bool">true</errorOnTimeout><quietTime type="number">300</quietTime></wait></stepConf></step><step name="extract" version="3.0"><stepConf type="object"><reqVer type="string">3.0</reqVer><node type="object"><frames type="array"/><xpath type="string">id("searchResults")/DIV[@class="record"][1]</xpath></node><sourceAttribute type="string">class</sourceAttribute><attributes type="array"><item type="string">class</item><item type="string">style</item></attributes><jsonPath type="object"><path type="string">$.temp</path><key type="string">results</key><append type="number">3</append></jsonPath></stepConf></step><step name="retry" version="0.2" alt="yes"><stepConf type="object"><reqVer type="string">0.2</reqVer><delay type="number">150</delay><maxCount type="number">10</maxCount><stepsBack type="number">1</stepsBack></stepConf></step><step name="skip" version="1.1"><stepConf type="object"><reqVer type="string">1.1</reqVer><compareTo type="object"><path type="string">$.input</path><key type="string">resumptiontoken</key></compareTo><rel type="string">neq</rel><expArgVal type="string">continues</expArgVal><useRegex type="bool">false</useRegex><stepsToSkip type="number">7</stepsToSkip><skipAll type="bool">false</skipAll><destType type="string">Retry</destType></stepConf></step><step name="nav_to" version="4.0"><stepConf type="object"><reqVer type="string">4.0</reqVer><wait type="object"><active type="bool">true</active><detector type="string">progressListen</detector><timeout type="number">30000</timeout><errorOnTimeout type="bool">true</errorOnTimeout></wait><rawxml type="bool">false</rawxml><hashonly type="bool">false</hashonly><usejp type="bool">false</usejp><jp type="object"/><usedArgs type="array"/><url type="string">http://digital2.library.ucla.edu/sheetmusic/</url><inline type="object"><pruned type="string">http://digital2.library.ucla.edu/sheetmusic/</pruned><paths type="array"/></inline></stepConf></step><step name="click" version="1.0"><stepConf type="object"><reqVer type="string">1.0</reqVer><target type="object"><frames type="array"/><xpath type="string">id("advancedSearchButton")</xpath></target><wait type="object"><active type="bool">false</active><detector type="string">progressListen</detector><timeout type="number">30000</timeout><errorOnTimeout type="bool">true</errorOnTimeout></wait></stepConf></step><step name="click" version="1.0"><stepConf type="object"><reqVer type="string">1.0</reqVer><target type="object"><frames type="array"/><xpath type="string">id("digitizedContent")</xpath></target><wait type="object"><active type="bool">false</active><detector type="string">progressListen</detector><timeout type="number">30000</timeout><errorOnTimeout type="bool">true</errorOnTimeout></wait></stepConf></step><step name="click" version="1.0"><stepConf type="object"><reqVer type="string">1.0</reqVer><target type="object"><namespaces type="object"/><frames type="array"/><xpath type="string">id("advancesearchForm")//input[contains(@type, "submit")]</xpath></target><wait type="object"><active type="bool">true</active><detector type="string">progressListen</detector><timeout type="number">30000</timeout><errorOnTimeout type="bool">true</errorOnTimeout></wait></stepConf></step><step name="set_value" version="4.0"><stepConf type="object"><reqVer type="string">4.0</reqVer><dest type="object"><frames type="array"/><xpath type="string">id("rows")</xpath></dest><param type="object"/><constant type="string">100</constant><usejp type="bool">false</usejp><onempty type="string">empty</onempty></stepConf></step><step name="extract" version="3.0"><stepConf type="object"><reqVer type="string">3.0</reqVer><node type="object"><frames type="array"/><xpath type="string">id("searchResults")/DIV[@class="pager"][2]</xpath></node><sourceAttribute type="string">textContent</sourceAttribute><attributes type="array"><item type="string">class</item><item type="string">style</item></attributes><jsonPath type="object"><path type="string">$.temp</path><key type="string">max</key><append type="number">3</append></jsonPath></stepConf></step><step name="retry" version="0.2" alt="yes"><stepConf type="object"><reqVer type="string">0.2</reqVer><delay type="number">100</delay><maxCount type="number">6</maxCount><stepsBack type="number">1</stepsBack></stepConf></step><step name="parse_xpattern" version="3.0" disabled="yes"><stepConf type="object"><reqVer type="string">3.0</reqVer><xpattern type="string">div  { img [ @src $thumburl  ] } : h4 $title : a [ @target $fulltexturl  ] : div : table  { tbody  { tr  { td : td $author } : tr  { td : td $date } : tr  { td : td $location } } } : table : div  { br : button [ @onclick $detailtoken  ] } </xpattern><hitarea type="object"><namespaces type="object"/><frames type="array"/><xpath type="string">/html/body</xpath></hitarea><jsonPath type="object"><path type="string">$.output</path><key type="string">records</key></jsonPath><highlighthits type="bool">true</highlighthits><autogenerate type="bool">true</autogenerate><hitnumbercheck type="bool">false</hitnumbercheck><failhitnumber type="bool">true</failhitnumber><removehitnumber type="bool">true</removehitnumber><keephitnumber type="bool">true</keephitnumber><hitnumbervar type="object"><path type="string">$.session</path><key type="string">hitnumber</key></hitnumbervar><xpatternhistory type="array"><item type="string">div  { img [ @src $thumburl  ] } : h4 $title : a [ @target $fulltexturl  ] : div : table  { tbody  { tr  { td : td $author } : tr  { td : td $date } : tr  { td : td $location } } } : table : div  { br : button [ @onclick $detailtoken  ] } </item><item type="string">div  { img [ @src $thumburl  ] } : h4 $title : a [ @target $fulltexturl  ] : div : table  { tbody  { tr  { td : td $author } : tr  { td : td $date } : tr  { td : td $location } } } : table : div  { br : button [ @onclick  ] } </item><item type="string">div  { img [ @src $thumburl  ] } : h4 $title : a [ @target $fulltexturl  ] : div : table  { tbody  { tr  { td : td $author } : tr  { td : td $date } : tr  { td : td $location } } } : table : div  { br : button [ @type  ] } </item><item type="string">div  { img [ @src $thumburl  ] } : h4 $title : a [ @target $fulltexturl  ] : div : table  { tbody  { tr  { td : td $author } : tr  { td : td $date } : tr  { td : td $location } } } : table : div  { br : button [ @style  ] } </item><item type="string">div  { img [ @src $thumburl  ] } : h4 $title : a [ @target $fulltexturl  ] : div : table  { tbody  { tr  { td : td $author } : tr  { td : td $date } : tr  { td : td $location } } } : table : div  { br : button [ @onclick = "renderFullRecordView(0)"  ] } </item><item type="string">div  { img [ @src $thumburl  ] } : h4 $title : a [ @target $fulltexturl  ] : div : table  { tbody  { tr  { td : td $author } : tr  { td : td $date } : tr  { td : td $location } } } : table : div  { br : button } </item><item type="string">div  { img [ @src $thumburl  ] } : h4 $title : a [ @target $fulltexturl  ] : div : table  { tbody  { tr  { td : td $author } : tr  { td : td $date } : tr  { td : td $location } } } </item><item type="string">div  { img [ @src $thumburl  ] } : h4 $title : a [ @target  ] : div : table  { tbody  { tr  { td : td $author } : tr  { td : td $date } : tr  { td : td $location } } } </item><item type="string">div  { img [ @src $thumburl  ] } : h4 $title : a : div : table  { tbody  { tr  { td : td $author } : tr  { td : td $date } : tr  { td : td $location } } } </item><item type="string">div  { img [ @src  ] } : h4 $title : a : div : table  { tbody  { tr  { td : td $author } : tr  { td : td $date } : tr  { td : td $location } } } </item><item type="string">div  { img [ @onerror  ] } : h4 $title : a : div : table  { tbody  { tr  { td : td $author } : tr  { td : td $date } : tr  { td : td $location } } } </item><item type="string">div  { img } : h4 $title : a : div : table  { tbody  { tr  { td : td $author } : tr  { td : td $date } : tr  { td : td $location } } } </item><item type="string">h4 $title : a : div : table  { tbody  { tr  { td : td $author } : tr  { td : td $date } : tr  { td : td $location } } } </item><item type="string">h4 $title : a : div : table  { tbody  { tr  { td : td $author } : tr  { td : td $date } : tr  { td : td } } } </item><item type="string">h4 $title : a : div : table  { tbody  { tr  { td : td $author } : tr  { td : td $date } } } </item><item type="string">h4 $title : a : div : table  { tbody  { tr  { td : td $author } : tr  { td : td } } } </item><item type="string">h4 $title : a : div : table  { tbody  { tr  { td : td $author } } } </item><item type="string">h4 $title : a : div : table  { tbody  { tr  { td : td } } } </item><item type="string">h4 $title </item><item type="string">h4 </item></xpatternhistory></stepConf></step><step name="parse_xpattern" version="3.0"><stepConf type="object"><xpattern type="string">div  { img [ @src $thumburl ] } : h4 $title : a : div : table  { tbody  { ( tr  { td [ /Publisher/ ] : td $publisher } | tr  { td [ /Date/ ] : td $date } | tr  { td [ /Repository/ ] : td $location } | any ) + } } : any *? : div  { br : button [ @onclick $detailtoken  ] } </xpattern><hitarea type="object"><namespaces type="object"/><frames type="array"/><xpath type="string">html/body</xpath></hitarea><jsonPath type="object"><path type="string">$.output</path><key type="string">records</key></jsonPath><highlighthits type="bool">true</highlighthits><autogenerate type="bool">true</autogenerate><hitnumbercheck type="bool">false</hitnumbercheck><failhitnumber type="bool">true</failhitnumber><removehitnumber type="bool">true</removehitnumber><keephitnumber type="bool">true</keephitnumber><hitnumbervar type="object"><path type="string">$.session</path><key type="string">hitnumber</key></hitnumbervar><xpatternhistory type="array"><item type="string">div  { img [ @src $thumburl ] } : h4 $title : a : div : table  { tbody  { ( tr  { td [ /Publisher/ ] : td $publisher } | tr  { td [ /Date/ ] : td $date } | tr  { td [ /Repository/ ] : td $location } | any ) + } } : any *? : table [ @class ~ /jsonCont/ ] </item><item type="string">div  { img [ @src $thumburl ] } : h4 $title : a : div : table  { tbody  { ( tr  { td [ /Publisher/ ] : td $publisher } | tr  { td [ /Date/ ] : td $date } | tr  { td [ /Publisher/ ] : td $publisher } | any ) + } } </item><item type="string">div  { img [ @src  ] } : h4 : a : div : table  { tbody  { tr  { td : td } } } </item><item type="string">div  { img [ @src  ] } : h4 </item><item type="string">div  { img [ @onerror  ] } : h4 </item><item type="string">div  { img } : h4 </item><item type="string">h4 </item></xpatternhistory></stepConf></step><step name="transform" version="3.1"><stepConf type="object"><reqVer type="string">3.1</reqVer><usedArgs type="array"/><container type="string"></container><in type="object"><path type="string">$.output.records[*]</path><key type="string">detailtoken</key></in><regex type="string">.*(\d).*</regex><outputs type="array"><item type="object"><replacement type="string">$1</replacement><jp type="object"><append type="number">3</append><unchanged type="bool">true</unchanged><key type="string">detailtoken</key><path type="string">$.output.records[*]</path></jp><inline type="object"><pruned type="string">$1</pruned><paths type="array"/></inline></item></outputs><icase type="bool">false</icase><global type="bool">false</global><cleanWhitespace type="bool">true</cleanWhitespace><noMatchFail type="bool">true</noMatchFail><noMatchNoop type="bool">false</noMatchNoop></stepConf></step><step name="set_result" version="1.1"><stepConf type="object"><reqVer type="string">1.1</reqVer><constant type="string">continues</constant><result type="string"></result><advanced type="bool">false</advanced><eval type="bool">false</eval><jsonPath type="object"><path type="string">$.output</path><key type="string">resumptiontokens</key><append type="number">3</append></jsonPath></stepConf></step><step name="extract" version="3.0"><stepConf type="object"><reqVer type="string">3.0</reqVer><node type="object"><namespaces type="object"/><frames type="array"/><xpath type="string">//a[@class="nextResultsButton"]</xpath></node><sourceAttribute type="string">textContent</sourceAttribute><attributes type="array"><item type="string">onclick</item><item type="string">class</item><item type="string">style</item></attributes><jsonPath type="object"><path type="string">$.temp</path><key type="string">next</key><append type="number">3</append></jsonPath></stepConf></step><step name="delete" version="1.0" alt="yes"><stepConf type="object"><reqVer type="string">1.0</reqVer><target type="object"><path type="string">$.output</path><key type="string">resumptiontokens</key></target></stepConf></step><test name="Default"/><test name="Resume"><arg name="resumptiontoken" value="continues"/></test></task><task name="detail" polymorphic="false"><step name="click" version="1.0"><stepConf type="object"><reqVer type="string">1.0</reqVer><target type="object"><namespaces type="object"/><frames type="array"/><xpath type="string">id("jsonContainer{$.input.detailtoken}")/following-sibling::div/button</xpath></target><wait type="object"><active type="bool">true</active><detector type="string">justObserve</detector><timeout type="number">30000</timeout><errorOnTimeout type="bool">true</errorOnTimeout></wait></stepConf></step><step name="delay" version="0.1"><stepConf type="object"><delay type="string">200</delay></stepConf></step><step name="parse_xpattern" version="3.0"><stepConf type="object"><xpattern type="string">tbody { ( tr { td [/^Title$/]: td $title } | tr { td [/^Creator$/]: td $author } | tr { td [/^Publisher$/]: td $publisher } | tr { td [/Topic|Geographic|Genre/]: td $subject } | tr { td [/^Note$/]: td $description } | tr { td [/^URL|^Identifier/]: td $url }| any ) +}</xpattern><hitarea type="object"><namespaces type="object"/><frames type="array"/><xpath type="string">//table[@style="border-collapse: collapse;"]</xpath></hitarea><jsonPath type="object"><path type="string">$.output</path><key type="string">results</key></jsonPath><highlighthits type="bool">true</highlighthits><autogenerate type="bool">true</autogenerate><hitnumbercheck type="bool">false</hitnumbercheck><failhitnumber type="bool">true</failhitnumber><removehitnumber type="bool">true</removehitnumber><keephitnumber type="bool">true</keephitnumber><hitnumbervar type="object"><path type="string">$.session</path><key type="string">hitnumber</key></hitnumbervar><xpatternhistory type="array"><item type="string">tbody { ( tr { td [/^Title$/]: td $title } | tr { td [/^Creator$/]: td $author } | tr { td [/^Publisher$/]: td $publisher } | tr { td [/Topic|Geographic|Genre/]: td $subject } | tr { td [/^Note$/]: td $description } | tr { td [/^URL|^Identifier/]: td $url }| any ) +}</item><item type="string">tbody { ( tr { td [/^Title$/]: td $title } | tr { td [/^Creator$/]: td $author } | tr { td [/^Publisher$/]: td $publisher } | tr { td [/^Topic$|Geographic/]: td $subject } | any ) +}</item><item type="string">tbody { tr { td [/^Title$/]: td $title } }</item><item type="string">tr { td [/^Title$/]: td $title }</item><item type="string">tr { td [/Title/: td $title }</item><item type="string">td : td $title </item><item type="string">td $title </item><item type="string">td </item></xpatternhistory></stepConf></step><step name="click" version="1.0"><stepConf type="object"><reqVer type="string">1.0</reqVer><target type="object"><namespaces type="object"/><frames type="array"/><xpath type="string">id("jsonContainer{$.input.detailtoken}")/following-sibling::div/button</xpath></target><wait type="object"><active type="bool">false</active><detector type="string">justObserve</detector><timeout type="number">30000</timeout><errorOnTimeout type="bool">true</errorOnTimeout></wait></stepConf></step><test name="Default"><arg name="detailtoken" value="2"/></test></task></connector>